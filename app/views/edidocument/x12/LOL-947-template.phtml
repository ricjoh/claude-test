<?php ob_start(); ?>
ISA*00*          *00*          *01*004798716      *08*<?= $data['ISAReceiverID'] ?>*<?= date('ymd') ?>*<?= date('Hi') ?>*U*00401*<?= $data['ISACtrlNo'] ?>*0*P*>
GS*AW*004798716*<?= $data['ISAReceiverID'] ?>*<?= date('Ymd') ?>*<?= date('Hi') ?>*<?= $data['GSCtrlNo'] ?>*X*004010~
ST*947*<?= $data['STCtrlNo'] ?>~
W15*<?= date('Ymd') ?>*<?= $data['WarehouseAdjustmentNumber'] ?>*<?= $data['DepositorAdjustmentNumber'] ?>~
N1*DE*LAND O LAKES*9*62538350000~
N1*WH*OSHKOSH COLD STORAGE-PLYMOUTH WI*6*721~
N9*BT*<?= $data['referenceIdentification'] ?>~
G62*07*<?= date('Ymd') ?>~
<? if ($data['noteSpecialInstructions'] !== '') : $data['SECount']++; ?>
NTE*ALL*<?= $data['noteSpecialInstructions'] ?>~
<? endif ?>
<?php foreach ($data['lines'] as $line) : ?>
W19*<?= $line['adjustmentReasonCode'] ?>*<?= $line['CreditDebitQuantity'] ?>*<?= $line['measurementUnit'] ?>*<? $line['upcCaseCode'] ?>*<?= $line['productIDQualifier'] ?>*<?= $line['productID'] ?>*LT*<?= $data['referenceIdentification'] ?>*<?= $line['OshLotNumber'] ?>*<?= $line['netWeight'] ?>*N*L****<?= $line['inventoryTransactionType'] ?>*ZZ*<?= $line['MDProductID'] ?>~
<?php endforeach ?>
SE*<?= $data['SECount'] ?>*<?= $data['STCtrlNo'] ?>~
GE*1*<?= $data['GSCtrlNo'] ?>~
IEA*1*<?= $data['ISACtrlNo'] ?>~
<?php
$filecontents = ob_get_contents();
ob_end_clean();
header("Content-Type: application/json; charset=UTF-8");

if (file_put_contents($filename, $filecontents)) {
	echo json_encode(array('success' => 1));
} else {
	echo json_encode(array('success' => 0, 'msg' => "Failed to write file: $filename"));
}
/*
EXAMPLE DOCUMENTS

ISA*00*          *00*          *01*604016766      *08*006253835DFP   *191025*1419*U*00401*000127722*0*P*>
GS*AW*8157445551*006253835DFP*20191025*1419*127722*T*004010
ST*947*0001
W15*20191025*ADJ0571585*16564481
N1*DE*LAND O LAKES*9*62538350000
N1*WH*INTERSTATE WAREHOUSING*6*398
N9*BT*169926605
G62*07*20191025
W19*AK*-1*BL**SW*40598000034500*LT*169926605*200121*-43.61*N*L****AD*ZZ*0
SE*8*0001
GE*1*127722
IEA*1*000127722

ISA*00*          *00*          *01*604016766      *08*006253835DFP   *191028*1541*U*00401*000127951*0*P*>
GS*AW*8157445551*006253835DFP*20191028*1541*127951*T*004010
ST*947*0001
W15*20191028*ADJ0571680*16565819
N1*DE*LAND O LAKES*9*62538350000
N1*WH*INTERSTATE WAREHOUSING*6*398
N9*BT*1461927394
G62*07*20191028
W19*AK*89*CA**SW*59703000034500*LT*1461927394*200227*934.50*N*L****SA*ZZ*0
SE*8*0001
GE*1*127951
IEA*1*000127951

ISA*00*          *00*          *01*604016766      *08*006253835DFP   *191025*0941*U*00401*000127678*0*P*>
GS*AW*8157445551*006253835DFP*20191025*0941*127678*T*004010
ST*947*0001
W15*20191025*ADJ0571571*ADJ0571571
N1*DE*LAND O LAKES*9*62538350000
N1*WH*INTERSTATE WAREHOUSING*6*398
N9*BT*1501927720
G62*07*20191025
W19*AA*12*CA**SW*19002000034500*LT*1501927720*200302*80.40*N*L****SA*ZZ*0
SE*8*0001
GE*1*127678
IEA*1*000127678

ISA*00*          *00*          *01*604016766      *08*006253835DFP   *191025*1519*U*00401*000127727*0*P*>
GS*AW*8157445551*006253835DFP*20191025*1519*127727*T*004010
ST*947*0001
W15*20191025*ADJ0571587*ADJ0571587
N1*DE*LAND O LAKES*9*62538350000
N1*WH*INTERSTATE WAREHOUSING*6*398
N9*BT*32962135
G62*07*20191025
W19*AA*-1*CA**SW*15192000034500*LT*32962135*200401*-12.00*N*L****AD*ZZ*0
SE*8*0001
GE*1*127727
IEA*1*000127727

ISA*00*          *00*          *01*604016766      *08*006253835DFP   *190930*1441*U*00401*000124068*0*P*>
GS*AW*8157445551*006253835DFP*20190930*1441*124068*T*004010
ST*947*0001
W15*20190930*ADJ0568117*ADJ0568117
N1*DE*LAND O LAKES*9*62538350000
N1*WH*INTERSTATE WAREHOUSING*6*398
N9*BT*32987830
G62*07*20190930
W19*07*-53*CA**SW*87586660053942*LT*32987830*190823*-636.00*N*L****AD*ZZ*HOLD
SE*8*0001
GE*1*124068
IEA*1*000124068

ISA*00*          *00*          *01*604016766      *08*006253835DFP   *190930*1441*U*00401*000124068*0*P*>
GS*AW*8157445551*006253835DFP*20190930*1441*124068*T*004010
ST*947*0001
W15*20190930*ADJ0568117*ADJ0568117
N1*DE*LAND O LAKES*9*62538350000
N1*WH*INTERSTATE WAREHOUSING*6*398
N9*BT*32987830
G62*07*20190930
W19*07*-53*CA**SW*87586660053942*LT*32987830*190823*-636.00*N*L****AD*ZZ*HOLD
SE*8*0001
GE*1*124068
IEA*1*000124068

ISA*00*          *00*          *01*604016766      *08*006253835DFP   *190930*1441*U*00401*000124071*0*P*>
GS*AW*8157445551*006253835DFP*20190930*1441*124071*T*004010
ST*947*0001
W15*20190930*ADJ0568120*ADJ0568120
N1*DE*LAND O LAKES*9*62538350000
N1*WH*INTERSTATE WAREHOUSING*6*398
N9*BT*33013404
G62*07*20190930
W19*07*-2*CA**SW*73010660073491*LT*33013404*190904*-16.00*N*L****AD*ZZ*HOLD
SE*8*0001
GE*1*124071
IEA*1*000124071

ISA*00*          *00*          *01*604016766      *08*006253835DFP   *190906*1619*U*00401*000120574*0*P*>
GS*AW*8157445551*006253835DFP*20190906*1619*120574*T*004010
ST*947*0001
W15*20190906*ADJ0560756*50886195
N1*DE*LAND O LAKES*9*62538350000
N1*WH*INTERSTATE WAREHOUSING*6*398
N9*BT*33055902
G62*07*20190906
W19*AV*-2*CA**SW*51000000073491*LT*33055902*191109*-16.50*N*L****AD*ZZ*0
SE*8*0001
GE*1*120574
IEA*1*000120574

ISA*00*          *00*          *01*604016766      *08*006253835DFP   *191028*1219*U*00401*000127913*0*P*>
GS*AW*8157445551*006253835DFP*20191028*1219*127913*T*004010
ST*947*0001
W15*20191028*ADJ10281223101*AGED
N1*DE*LAND O LAKES*9*62538350000
N1*WH*INTERSTATE WAREHOUSING*6*398
N9*BT*33072597
G62*07*20191028
W19*AX*38*CA**SW*00051660073491*LT*33072597*191127*456.00*N*L****SA*ZZ*0
W19*AX*-38*CA**SW*00051000073491*LT*33072597*191127*-456.00*N*L****AD*ZZ*0
SE*9*0001
GE*1*127913
IEA*1*000127913
*/
?>